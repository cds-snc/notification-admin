{% from "components/buttons.html" import nav_button %}

{% set lang_switch = 'EN' %}
{% set long_lang_switch = 'English' %}

{% if session["userlang"] == "en" %}
  {% set lang_switch = 'FR' %}
  {% set long_lang_switch = 'Fran√ßais' %}
{% endif %}

<div class="container px-gutterHalf">
  <!-- start sub nav -->
  <div class="pt-5 lg:justify-between grid md:grid-cols-2">
    <div>
      {% if session["userlang"] == "en" %}
        <img
          alt="{{ _('Government of Canada') }}"
          width="250"
          class="focus:bg-yellow focus:outline-yellow focus:border-yellow focus:border-2"
          src="{{ asset_s3_url('gov-canada-en.svg') }}"
        />
      {% else %}
        <img
          alt="{{ _('Government of Canada') }}"
          width="250"
          class="focus:bg-yellow focus:outline-yellow focus:border-yellow focus:border-2"
          src="{{ asset_s3_url('gov-canada-fr.svg') }}"
        />
      {% endif %}
    </div>
    <!-- start sub nav -->
    <nav aria-label="{{ _('language and sign-in') }}"
         class="xs:hidden smaller:hidden sm:hidden md:flex justify-end">
      {% if current_user.is_authenticated %}
        {% include 'partials/nav/account_menu.html' %}
      {% else %}
        {{ nav_button(
          href=url_for('main.sign_in'),
          label=_('Sign in')
        ) }}
      {% endif %}
      {{ nav_button(
        href=url_for('main.set_lang') + "?from=" + request.path,
        label=long_lang_switch,
        aria_label=long_lang_switch,
        lang="fr-CA" if lang_switch == "FR" else "en-CA",
        class="mr-0 ml-5"
      ) }}
    </nav>
    <!-- end sub nav -->
  </div>
  <div class="pt-5 pb-6">
    <div>
      <a href="/" class="py-1 no-underline focus:outline-none focus:border-b-2 focus:border-blue focus:text-blue">
        {% if not current_user.is_authenticated or current_user.is_authenticated and not current_user.has_permissions()
        and not platform_admin_view_ind %}
          <span id="gc-title"
                class="text-titlelarge text-black visited:text-black"
          >
          {{ _("GC Notify") }}
        </span>
        {% else %}
          <span id="gc-title"
                class="text-title text-black visited:text-black"
          >
          {{ _("GC Notify") }}
        </span>
        {% endif %}
      </a>
    </div>
    {% set url_text = current_service.name %}
    {% if platform_admin_view_ind %}
      {% set url_text = _('Admin panel') %}
    {% endif %}

    {% if current_user.is_authenticated and current_user.has_permissions() or platform_admin_view_ind %}
      <div>
        <h2 class="font-bold text-titlelarge text-black inline">
          {{ url_text }}
        </h2>
        {% if current_user.has_permissions() and not platform_admin_view_ind and current_service.trial_mode %}
        <a
          class="self-end mb-4 py-2 px-1 inline-block align-middle focus:outline-none border-b-2 border-transparent focus:border-blue"
          href="{{ url_for('main.request_to_go_live', service_id=current_service.id) }}"
          role="button">
          <div class="flex flex-initial flex-row items-baseline text-base">
            <div
              id="live-banner"
              class="shadow-button2 px-6 py-1 bg-blue-lighter text-black text-small font-bold inline-block mr-4">
              {{ _('Trial') }}
            </div>
            <div class="inline-block text-small underline visited:text-blue link:text-blue">
              {% if current_service.pending_live %}
                {{ _('Request being reviewed') }}
              {% else %}
                {{ _('Request to go live') }}
              {% endif %}
            </div>
          </div>
        </a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>
